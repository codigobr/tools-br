(function(){var t,e,n,r,i,o,l,s,u,a,p,h,c,d,f,w,m,g,y,v,T,x={}.hasOwnProperty,b=function(t,e){for(var n in e)x.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};h=!1,"undefined"!=typeof module&&null!==module&&(h=!0),m="undefined"!=typeof exports&&null!==exports?exports:null!=this.Html2Jade?this.Html2Jade:this.Html2Jade={},h?(n=require("fs"),require("path"),e=require("he")):(e=he,window.Html2Jade=m),f=2,y=!1,a=!1,p={useNamedReferences:!0},T=/^[\w\-]+$/,v=/^[\w\-]+$/,i=function(){function t(t){this.options=null!=t?t:{},h&&(this.jsdom=require("jsdom-little"))}return t.prototype.parse=function(t,e){var r,i;return t?("file"===this.options.inputType&&(t=n.readFileSync(t,"utf8")),h?this.jsdom.env(t,e):(i={},r=new DOMParser,i.document=r.parseFromString(t,"text/html"),e(null,i))):e("null file")},t}(),d=function(t){return(t=t?t.trim():"")&&T.test(t)},c=function(t){return(t=t?t.trim():"")&&v.test(t)},s=function(){function t(t){var e,n,r;null==t&&(t={}),this.wrapLength=null!=(e=t.wrapLength)?e:80,this.scalate=null!=(n=t.scalate)&&n,this.attrSep=this.scalate||t.noattrcomma?" ":", ",t.double?(this.attrQuote='"',this.nonAttrQuote="'"):(this.attrQuote="'",this.nonAttrQuote='"'),this.attrQuoteEscaped="\\"+this.attrQuote,this.noEmptyPipe=null!=(r=t.noemptypipe)&&r}return t.prototype.tagHead=function(t){var e;return e="DIV"!==t.tagName?t.tagName.toLowerCase():"",t.id&&d(t.id)&&(e+="#"+t.id),t.hasAttribute("class")&&t.getAttribute("class").length>0&&(e+="."+t.getAttribute("class").split(/\s+/).filter(function(t){return t&&c(t)}).join(".")),0===e.length&&(e="div"),e},t.prototype.tagAttr=function(t,e){var n,r,i,o,l,s,u,a;if(null==e&&(e=""),(o=t.attributes)&&0!==o.length){for(s=[],u=0,a=o.length;u<a;u++)(n=o[u])&&n.nodeName&&(r=n.nodeName,i=n.nodeValue,"id"===r&&d(i)||("class"===r?(l=t.getAttribute("class").split(/\s+/).filter(function(t){return t&&!c(t)})).length>0&&s.push(this.buildTagAttr(r,l.join(" "))):(i=i.replace(/(\r|\n)\s*/g,"\\$1"+e),s.push(this.buildTagAttr(r,i)))));return s.length>0?"("+s.join(this.attrSep)+")":""}return""},t.prototype.buildTagAttr=function(t,e){return-1===e.indexOf(this.attrQuote)?t+"="+this.attrQuote+e+this.attrQuote:-1===e.indexOf(this.nonAttrQuote)?t+"="+this.nonAttrQuote+e+this.nonAttrQuote:(e=e.replace(new RegExp(this.attrQuote,"g"),this.attrQuoteEscaped),t+"="+this.attrQuote+e+this.attrQuote)},t.prototype.tagText=function(t){var e,n;return 3!==(null!=(n=t.firstChild)?n.nodeType:void 0)?null:t.firstChild!==t.lastChild?null:(e=t.firstChild.data).length>this.wrapLength||e.match(/\r|\n/)?null:e},t.prototype.forEachChild=function(t,e){var n,r;if(t){for(n=t.firstChild,r=[];n;)e(n),r.push(n=n.nextSibling);return r}},t.prototype.writeTextContent=function(t,e,n){var r=this;return e.enter(),this.forEachChild(t,function(t){return r.writeText(t,e,n)}),e.leave()},t.prototype.writeText=function(t,e,n){var r,i=this;if(3===t.nodeType&&(r=t.data||"").length>0)return r.split(/\r|\n/).forEach(function(r){return i.writeTextLine(t,r,e,n)})},t.prototype.writeTextLine=function(t,n,r,i){var o,l,s,u,a,h,c,d,f,w,m,g,y,v=this;if(null==i&&(i={}),u=null==(c=i.pipe)||c,null!=(d=i.trim)&&d,h=null==(f=i.wrap)||f,o=null!=(w=i.encodeEntityRef)&&w,l=null!=(m=i.escapeBackslash)&&m,!u||!this.noEmptyPipe||0!==n.trim().length)return a=u?"| ":"",1!==(null!=t&&null!=(g=t.previousSibling)?g.nodeType:void 0)&&(n=n.trimLeft()),1!==(null!=t&&null!=(y=t.nextSibling)?y.nodeType:void 0)&&(n=n.trimRight()),n?(o&&(n=e.encode(n,p)),l&&(n=n.replace("\\","\\\\")),!h||n.length<=this.wrapLength?r.writeln(a+n):1===(s=this.breakLine(n)).length?r.writeln(a+n):s.forEach(function(e){return v.writeTextLine(t,e,r,i)})):void 0},t.prototype.breakLine=function(t){var e,n,r;if(!t||0===t.length)return[];if(t.search(!1))return[t];for(e=[],r=t.split(/\s+/),t="";r.length;)n=r.shift(),t.length+n.length>this.wrapLength?(e.push(t),t=n):t.length?t+=" "+n:t=n;return t.length&&e.push(t),e},t}(),w={"-//W3C//DTD XHTML 1.0 Transitional//EN":"transitional","-//W3C//DTD XHTML 1.0 Strict//EN":"strict","-//W3C//DTD XHTML 1.0 Frameset//EN":"frameset","-//W3C//DTD XHTML 1.1//EN":"1.1","-//W3C//DTD XHTML Basic 1.1//EN":"basic","-//WAPFORUM//DTD XHTML Mobile 1.2//EN":"mobile"},g={"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd":"transitional","http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd":"strict","http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd":"frameset","http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd":"1.1","http://www.w3.org/TR/xhtml-basic/xhtml-basic11.dtd":"basic","http://www.openmobilealliance.org/tech/DTD/xhtml-mobile12.dtd":"mobile"},t=function(){function t(t){var e,n;this.options=null!=t?t:{},this.scalate=null!=(e=this.options.scalate)&&e,this.writer=null!=(n=this.options.writer)?n:new s(this.options)}return t.prototype.document=function(t,e){var n,r,i,o,l;return null!=t.doctype&&(n=void 0,o=(r=t.doctype).publicId,l=r.systemId,null!=o&&null!=w[o]?n=w[o]:null!=l&&null!=g[l]?n=null!=g[l]:null!=r.name&&"html"===r.name.toLowerCase()&&(n="html"),null!=n&&e.writeln("doctype "+n)),t.documentElement?this.children(t,e,!1):(i=t.getElementsByTagName("html")).length>0?this.element(i[0],e):void 0},t.prototype.element=function(t,n){var r,i,o,l,s;if(null!=t?t.tagName:void 0)return l=t.tagName.toLowerCase(),o=this.writer.tagHead(t),i=this.writer.tagAttr(t,n.indents),s=this.writer.tagText(t),"script"!==l&&"style"!==l?"conditional"===l?(n.writeln("//"+t.getAttribute("condition")),this.children(t,n)):-1!==["pre"].indexOf(l)?(n.writeln(o+i+"."),n.enter(),r=!0,this.writer.forEachChild(t,function(t){var e;if(3===t.nodeType&&null!=(e=t.data)&&e.length>0)return r&&(0===e.search(/\r\n|\r|\n/)&&(e=e.replace(/\r\n|\r|\n/,"")),e="\\n"+e,r=!1),e=(e=e.replace(/\t/g,"\\t")).replace(/\r\n|\r|\n/g,"\n"+n.indents),n.write(e)}),n.writeln(),n.leave()):!this.options.bodyless||"html"!==l&&"body"!==l?s?a?n.writeln(o+i+" "+s):n.writeln(o+i+" "+e.encode(s,p)):(n.writeln(o+i),this.children(t,n)):this.children(t,n,!1):t.hasAttribute("src")?(n.writeln(o+i),this.writer.writeTextContent(t,n,{pipe:!1,wrap:!1})):"script"===l?this.script(t,n,o,i):"style"===l?this.style(t,n,o,i):void 0},t.prototype.children=function(t,e,n){var r=this;if(null==n&&(n=!0),n&&e.enter(),this.writer.forEachChild(t,function(n){var i;return 1===(i=n.nodeType)?r.element(n,e):3===i?"code"===t._nodeName?r.text(n,e,{encodeEntityRef:!0,pipe:!0}):r.text(n,e,a?{encodeEntityRef:!1}:{encodeEntityRef:!0}):8===i?r.comment(n,e):void 0}),n)return e.leave()},t.prototype.text=function(t,e,n){return t.normalize(),this.writer.writeText(t,e,n)},t.prototype.comment=function(t,e){var n,r,i=this;return(n=t.data.match(/\s*\[(if\s+[^\]]+)\]/))?this.conditional(t,n[1],e):0===(r=t.data||"").length||-1===r.search(/\r|\n/)?e.writeln("// "+r.trim()):(e.writeln("//"),e.enter(),r.split(/\r|\n/).forEach(function(n){return i.writer.writeTextLine(t,n,e,{pipe:!1,trim:!0,wrap:!1})}),e.leave())},t.prototype.conditional=function(t,e,n){var r,i;return 0===(i=t.textContent.trim().replace(/\s*\[if\s+[^\]]+\]>\s*/,"").replace("<![endif]","")).indexOf("<!")&&(e=" ["+e+"] <!",i=null),(r=t.ownerDocument.createElement("conditional")).setAttribute("condition",e),i&&(r.innerHTML=i),t.parentNode.insertBefore(r,t.nextSibling)},t.prototype.script=function(t,e,n,r){return this.scalate?(e.writeln(":javascript"),this.writer.writeTextContent(t,e,{pipe:!1,wrap:!1})):(e.writeln(""+n+r+"."),this.writer.writeTextContent(t,e,{pipe:!1,trim:!0,wrap:!1,escapeBackslash:!0}))},t.prototype.style=function(t,e,n,r){return this.scalate?(e.writeln(":css"),this.writer.writeTextContent(t,e,{pipe:!1,wrap:!1})):(e.writeln(""+n+r+"."),this.writer.writeTextContent(t,e,{pipe:!1,trim:!0,wrap:!1}))},t}(),r=function(){function t(){this.indents=""}return t.prototype.enter=function(){var t,e;if(y)return this.indents+="\t";for(e=[],t=1;1<=f?t<=f:t>=f;1<=f?++t:--t)e.push(this.indents+=" ");return e},t.prototype.leave=function(){return this.indents=y?this.indents.substring(1):this.indents.substring(f)},t.prototype.write=function(t,e){null==e&&(e=!0)},t.prototype.writeln=function(t,e){null==e&&(e=!0)},t}(),l=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.fragments=[]}return b(e,r),e.prototype.write=function(t,e){return null==e&&(e=!0),null==t&&(t=""),e?this.fragments.push(this.indents+t):this.fragments.push(t)},e.prototype.writeln=function(t,e){return null==e&&(e=!0),null==t&&(t=""),e?this.fragments.push(this.indents+t+"\n"):this.fragments.push(t+"\n")},e.prototype.final=function(){var t;return t=this.fragments.join(""),this.fragments=[],t},e}(),o=function(t){function e(t){this.stream=t,e.__super__.constructor.apply(this,arguments)}return b(e,r),e.prototype.write=function(t,e){return null==e&&(e=!0),null==t&&(t=""),e?this.stream.write(this.indents+t):this.stream.write(t)},e.prototype.writeln=function(t,e){return null==e&&(e=!0),null==t&&(t=""),e?this.stream.write(this.indents+t+"\n"):this.stream.write(t+"\n")},e}(),m.Output=r,m.StringOutput=l,m.Converter=t,m.Writer=s,u=function(t){if(null!=t.numeric&&(p.useNamedReferences=!t.numeric),null!=t.nspaces&&(f=parseInt(t.nspaces)),null!=t.tabs&&(y=!!t.tabs),null!=t.donotencode)return a=!!t.donotencode},"undefined"!=typeof exports&&null!==exports&&(m.Parser=i,m.StreamOutput=o,m.convert=function(e,n,r){return null==r&&(r={}),u(r),null==r.parser&&(r.parser=new i(r)),r.parser.parse(e,function(e,i){return(null!=e?e.length:void 0)?e:(null==n&&(n=new o(process.stdout)),null==r.converter&&(r.converter=new t(r)),r.converter.document(i.document,n))})}),m.convertHtml=function(e,n,r){return null==n&&(n={}),u(n),null==n.parser&&(n.parser=new i(n)),n.parser.parse(e,function(e,i){var o,s;return(null!=e?e.length:void 0)?e:(o=null!=(s=n.output)?s:new l,null==n.converter&&(n.converter=new t(n)),n.converter.document(i.document,o),null!=r?r(null,o.final()):void 0)})},m.convertDocument=function(e,n,r){var i,o;if(null==n&&(n={}),u(n),i=null!=(o=n.output)?o:new l,null==n.converter&&(n.converter=new t(n)),n.converter.document(e,i),null!=r)return r(null,i.final())}}).call(this);